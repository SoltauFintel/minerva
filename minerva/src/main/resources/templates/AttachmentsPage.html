{{master: master}}

<script src="/js/dropzone.js"></script>
<script>
    Dropzone.options.myDropzone = {
        createImageThumbnails: false,
        maxFilesize: {{mb}},
        queuecomplete: function() {
            window.location.reload(false);
        },
        error: function(file) {
            console.log('file:', file);
            alert('Upload hat nicht geklappt! ' + file);
        },
    };

    function loeschen(dn, id) {
        ret = confirm('{{N.deleteAttachment1}}' + dn + '{{N.deleteAttachment2}}');
        if (ret) {
            document.querySelector('#' + id).style = '';
        }
        return ret;
    }
</script>

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">{{header}}</h1>
        
        <h2><a href="{{viewlink}}">{{pageTitle}}</a></h2>

        <p>Feature Preview! Bitte nur eine Datei hochladen! Das Hochladen mehrerer Dateien funktioniert noch nicht richtig.</p>
        {{dropzone}}

        {{if hasAttachments}}
            <table class="table table-striped table-hover mt2">
                <tr>
                    <th>{{N.Filename}}</th>
                    <th>{{N.Categories}}</th>
                    <th></th>
                </tr>
                {{each att in attachments}}
                    <tr>
                        <td><a href="{{viewlink}}/attachments/{{att.filename}}" target="_blank">{{att.filename}}</a></td>
                        <td>
                            {{each cat in att.categories}}
                                <span class="label label-info">{{cat.cat}}</span>
                            {{/each}}
                        </td>
                        <td style="text-align: right;">
                            <a href="{{viewlink}}/edit-attachment/{{att.filename}}" class="btn btn-xs btn-default"><i
                                class="fa fa-pencil"></i> {{N.EditCategories}}</a>
                            <a  onclick="return loeschen('{{att.filename}}', 'n_{{att.id}}');"
                                href="{{viewlink}}/delete-attachment/{{att.filename}}" class="btn btn-xs btn-danger" title="{{N.delete}}"><i
                                class="fa fa-trash-o"></i> <i id="n_{{att.id}}" class="fa fa-delicious fa-spin" style="display: none;"></i></a>
                       </td>
                    </tr>
                {{/each}}
            </table>
        {{else}}
            <p class="mt2">- keine Attachments vorhanden -</p>
        {{/if}}
    </div>
</div>
