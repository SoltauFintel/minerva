{{master: master_jqueryoben}}

<div class="row"> 
    <div class="col-lg-12">
        <h1 class="page-header">{{header}}</h1>
        
        <h2><a href="{{viewlink}}">{{pageTitle}}</a></h2>
        
        {{if hasParent}}
            <div class="noteInfo mt2">
                <p class="noteText">{{parentText}}</p>
            </div>
        {{/if}}

        <form action="{{viewlink}}/add-note?parent={{parentId}}" class="editorform form-horizontal mt3" method="post">
            <fieldset>
                <div class="form-group">
                    <label for="text1" class="col-lg-1 control-label">{{N.note}}</label>
                    <div class="col-lg-5">
                        <textarea class="form-control noteTextarea" id="text1" name="text1" rows="8"
                            autofocus></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="person" class="col-lg-1 control-label">{{N.zustaendig}}</label>
                    <div class="col-lg-2">
                        <select id="person" name="person" class="form-control" style="height: 10em;" multiple>
                            {{each o in persons}}
                                <option{{if o.selected}} selected{{/if}}>{{o.text}}</option>
                            {{/each}}
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-lg-offset-1 col-lg-5">
                        <button type="submit" class="btn btn-primary br"
                            onclick="document.querySelector('#s1').style='';">{{N.save}}
                            <i id="s1" class="fa fa-delicious fa-spin" style="display: none;"></i></button>
                        <a href="{{viewlink}}/notes" class="btn btn-default">{{N.cancel}}</a>
                    </div>
                </div>
            </fieldset>
        </form>
        
        <p>{{info}}</p>
    </div>
</div>

<script>
$(window).on('beforeunload', function() {
    return 'Any changes will be lost';  {{-- // browser shows its own text --}}
});

$(document).on('submit', 'form.editorform', function(event) {  {{-- // allow Save button to leave without above question --}}
    $(window).off('beforeunload');
});
</script>
